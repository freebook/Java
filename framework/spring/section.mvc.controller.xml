<?xml version="1.0" encoding="UTF-8"?>
<section id="controller">
	<title>@Controller</title>
	<programlisting>
package cn.netkiller.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class Welcome {

	@RequestMapping("/welcome")
	public ModelAndView helloWorld() {

		String message = "Helloworld!!!";
		return new ModelAndView("welcome", "message", message);
	}
}
	</programlisting>

	<section id="RequestMapping">
		<title>@RequestMapping</title>
		<programlisting>
@RequestMapping("/welcome")
		</programlisting>
		<programlisting>
@RequestMapping(value = "/list", method = RequestMethod.GET)
		</programlisting>
		
		<section>
			<title>@RequestMapping("/")</title>
			<programlisting>
			<![CDATA[
package com.cf88.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
@RequestMapping("/")
public class HelloController {

	@RequestMapping(value = "/{name}", method = RequestMethod.GET)
	public String getMovie(@PathVariable String name, ModelMap model) {
		model.addAttribute("name", name);
		return "hello";
	}

}		
			]]>
			</programlisting>
		</section>		
		
		<section>
			<title>映射多个URL</title>
			<programlisting>
@RequestMapping({ "/news/zh-cn", "/news/zh-tw" })
@ResponseBody
public String getNewsByPath() {
    return "Hello";
}
			</programlisting>
		</section>
		<section>
			<title>headers</title>
			<programlisting>
			<![CDATA[
@RequestMapping(value = "/news/json", method = GET, headers = "Accept=application/json")
@ResponseBody
public String getFoosAsJsonFromBrowser() {
    return "{...}";
}
			]]>
			</programlisting>
			<screen>
curl -H "Accept:application/json,text/html" http://localhost:8080/spring/news/json.html
			</screen>
		</section>
	</section>
	<section id="ResponseBody">
		<title>@ResponseBody</title>
		<programlisting>
import org.springframework.web.bind.annotation.ResponseBody;
		</programlisting>
		<section>
			<title>直接返回HTML</title>
			<programlisting>
			<![CDATA[
package cn.netkiller.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class Pathinfo {

	@RequestMapping(value = "/news/shenzhen/{numericId:[\\d]+}")
	@ResponseBody
	public String getNewsWithPathVariable(@PathVariable final long numericId) {
		return "Get a specific Bar with id=" + numericId;
	}

}

			]]>
			</programlisting>
		</section>
	</section>
	
	<section id="PathVariable">
		<title>RequestMapping with Path Variables - @PathVariable</title>
		<section>
			<title>URL 参数传递</title>
			<para>需求，我们需要通过URL传递参数，所传递的值是分类ID与文章ID，例如 /news/1.html, /news/1/1.html。</para>
			<programlisting>
			<![CDATA[
package cn.netkiller.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class Pathinfo {
	@RequestMapping("/pathinfo/{id}")
	public ModelAndView urlTestId(@PathVariable String id) {

		return new ModelAndView("pathinfo/param", "id", id);
	}

	@RequestMapping("/pathinfo/{cid}/{id}")
	public ModelAndView urlTestId(@PathVariable String cid, @PathVariable String id) {

		ModelMap model = new ModelMap();

		model.addAttribute("cid", cid);
		model.addAttribute("id", id);

		return new ModelAndView("pathinfo/param", model);
	}
}
			]]>
			</programlisting>
			<para>jsp测试文件</para>
			<programlisting>
			<![CDATA[
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body>
${ cid } <br>
${ id } <br>
</body>
</html>
			]]>
			</programlisting>

		</section>
		<section>
			<title>URL 传递 Date 类型</title>
			<para>http://localhost:7000/history/2016-09-28%2000:00:00/</para>
			<programlisting>
			<![CDATA[
	@RequestMapping("/history/{datetime}")
	public String history(@PathVariable @DateTimeFormat(pattern="yyyy-MM-dd HH:mm:ss") Date datetime) throws Exception {

		System.out.println(datetime)

		return null;
	}			
			]]>
			</programlisting>
		</section>
		<section>
			<title>处理特殊字符</title>
			<para>http://www.netkiller.cn/release/1.0.1</para>
			<programlisting>
@RequestMapping(value = "/release/{version:[a-zA-Z0-9\\.]+}", method = RequestMethod.GET)  
public @ResponseBody  
String release(@PathVariable String version) {  
    log.debug("version: ", version);  
    return version;  
}
			</programlisting>
			<para>http://www.netkiller.cn/release/1.0.1/other</para>
			<programlisting>
@RequestMapping(value="/release/{version:.+}",method=RequestMethod.GET)
public void download(HttpSession session,@PathVariable("version")String version){
	return version;
}
			</programlisting>
		</section>
	</section>

	<section id="RequestParam">
		<title>RequestMapping with Request Parameters - @RequestParam</title>
		<programlisting>
import org.springframework.web.bind.annotation.RequestParam;
		</programlisting>
		<section>
			<title>HTTP GET</title>
			<programlisting>
			<![CDATA[
	@RequestMapping("/request/param")
	@ResponseBody
	public String getBarBySimplePathWithRequestParam(@RequestParam("id") long id) {
	    return "Get a specific Bar with id=" + id;
	}
			]]>
			</programlisting>
			<para></para>
			<screen>
http://localhost:8080/Spring/request/param.html?id=100
			</screen>
		</section>

		<section>
			<title>HTTP POST</title>
			<programlisting>
			<![CDATA[
package cn.netkiller.controller;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class Http {

	@RequestMapping("/http/form")
	public ModelAndView createCustomer(){
		ModelMap model = new ModelMap();

		model.addAttribute("email", "netkiller@msn.com");
		model.addAttribute("phone", "13113668890");

	    return new ModelAndView("http/form", model);
	}

	@RequestMapping(value= "/http/post", method = RequestMethod.POST)
	public ModelAndView saveCustomer(HttpServletRequest request,
	        @RequestParam(value="Email", required=false) String email,
	        @RequestParam(value="Password", required=false) String password,
	        @RequestParam(value="Phone", required=false) String phone){

		ModelMap model = new ModelMap();

		model.addAttribute("email", email);
		model.addAttribute("password", password);
		model.addAttribute("phone", phone);

	    return new ModelAndView("http/post", model);
	}

}
			]]>
			</programlisting>
			<para>http/form.jsp</para>
			<programlisting>
			<![CDATA[
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body>

	<form method="POST"
		action="http://localhost:8080/Spring/http/post.html" id="Register"
		name="Register">
		Email: <input class="register" type="text" id="Email" name="Email" value="${email}" /> <br />
		Password： <input class="register" type="password" id="Password" name="Password" value="" /><br />
		Phone： <input class="register" type="text" id="Phone" name="Phone" value="${phone}" /> <br />
		<input type="submit" id="btnRegister" name="btnRegister" value="Register" style="cursor: pointer" />
	</form>

</body>
</html>
			]]>
			</programlisting>
			<para>http/post.jsp</para>
			<programlisting>
			<![CDATA[
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body>
	${email}<br>
	${password}	<br>
	${phone} <br>
</body>
</html>
			]]>
			</programlisting>
		</section>
	</section>
	
	<section id="ModelAttribute">
		<title>@ModelAttribute</title>
		<para>@ModelAttribute 处理 HTML FORM POST 提交</para>
		<programlisting>
		<![CDATA[
package cn.netkiller.pojo;

import java.util.List;

public class Deploy {

	private String group;
	private String envionment;
	private String project;
	private List<String> arguments;
	public Deploy() {
		// TODO Auto-generated constructor stub
	}
	// Getters & Setters
}
		]]>
		</programlisting>
		<programlisting>
		<![CDATA[
	@RequestMapping(value="/deploy/post",  method = RequestMethod.POST)
	public ModelAndView post(@ModelAttribute("deploy")Deploy deploy, BindingResult result) {
		if (result.hasErrors()) {
			System.out.println(result.toString());
        }
		System.out.println(deploy.toString());
		return new ModelAndView("output").addObject("output", deploy.toString());
	}		
		]]>
		</programlisting>
	</section>
	<section id="ModelAndView">
		<title>ModelAndView</title>
		<section>
			<title>变量传递</title>
			<programlisting>
	@RequestMapping("/testString")
	public ModelAndView helloWorld() {
		String message = "Helloworld!!!";
		return new ModelAndView("welcome", "message", message);
	}
			</programlisting>

			<programlisting>
	public ModelAndView handleRequestInternal() {

		ModelAndView mav = new ModelAndView("test");// 实例化一个VIew的ModelAndView实例
		mav.addObject("variable", "Hello World!");// 添加一个带名的model对象
		return mav;
	}
			</programlisting>
		</section>
		<section>
			<title>ModelMap 传递多个变量</title>
			<para>传递多个字符串</para>
			<programlisting>
	@RequestMapping("/testModelMap")
	public ModelAndView testModelMap() {
		ModelMap model = new ModelMap();

		model.addAttribute("username", "Neo");
		model.addAttribute("password", "Netkiller");

		return new ModelAndView("test/modelmap", model);
	}
			</programlisting>
			<para>推荐使用ModelMap</para>
			<programlisting>
			<![CDATA[
	@RequestMapping("/testMapString")
	public ModelAndView testMapString() {

		Map<String,String> data = new HashMap<String,String>();
		data.put("username","Neo");
		data.put("password","Netkiller");
	    return new ModelAndView("test/modelmap",data);

	}
			]]>
			</programlisting>
			<programlisting>
			<![CDATA[
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
${username}<br>
${password}<br>
</body>
</html>
			]]>
			</programlisting>
		</section>
		<section>
			<title>redirect</title>
			<programlisting>
			<![CDATA[
	@RequestMapping("/testRedirect")
	public ModelAndView testRedirect(){
		   RedirectView view = new RedirectView("testMapString.html");
		   return new ModelAndView(view);
	}
			]]>
			</programlisting>
		</section>
		<section>
			<title>ArrayList</title>
			<programlisting>
			<![CDATA[
	@RequestMapping(value = "testList")
	public ModelAndView testList() {
		ModelAndView mav = new ModelAndView();
		mav.setViewName("/test/list");

		// List
		List<String> list = new ArrayList<String>();
		list.add("java");
		list.add("c++");
		list.add("oracle");
		mav.addObject("bookList", list);

		return mav;
	}
			]]>
			</programlisting>
			<programlisting>
			<![CDATA[
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
	${bookList}
	<br>

	<c:forEach items="${bookList}" var="node">
		<c:out value="${node}"></c:out><br>
	</c:forEach>

</body>
</html>
			]]>
			</programlisting>
		</section>
		<section>
			<title>HashMap</title>
			<programlisting>
			<![CDATA[
	@RequestMapping("/testMap")
	public ModelAndView testMap() {
		ModelAndView mav = new ModelAndView();
		mav.setViewName("test/map"); // 返回的文件名

		// Map
		Map<String, String> map = new HashMap<String, String>();
		map.put("Java", "http://www.netkiller.cn/java");
		map.put("PHP", "http://www.netkiller.cn/php");
		map.put("Home", "http://www.netkiller.cn");
		mav.addObject("channel", map);

		return mav;
	}
			]]>
			</programlisting>
			<programlisting>
			<![CDATA[
<%@ page language="java" contentType="text/html; charset=utf-8"
    pageEncoding="utf-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
	<c:forEach items="${channel}" var="node">
		<a href="<c:out value="${node.value}"></c:out>"><c:out value="${node.key}"></c:out></a>
        <br/>
	</c:forEach>
</body>
</html>
			]]>
			</programlisting>
		</section>
		<section>
			<title>传递对象</title>
			<programlisting>
			<![CDATA[
	@RequestMapping("/testObject")
	public ModelAndView testObject() {
		ModelMap model = new ModelMap();

		User user = new User("neo", "passw0rd");
		model.addAttribute("user", user);
		return new ModelAndView("test/object", model);

	}
			]]>
			</programlisting>
			<programlisting>
			<![CDATA[
package cn.netkiller;

public class User {
	public String username;
	public String password;
	public User(String username, String password){
		this.username = username;
		this.password = password;
	}
	public String getUsername(){
		return this.username;
	}
	public String getPassword(){
		return this.password;
	}
}
			]]>
			</programlisting>
			<programlisting>
			<![CDATA[
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
Username: ${user.username}<br>
Password: ${user.password}<br>
</body>
</html>
			]]>
			</programlisting>
		</section>
		<section>
			<title></title>
			<programlisting>
			<![CDATA[
			]]>
			</programlisting>
		</section>
	</section><section id="Scheduled">
		<title>@Scheduled</title>
		<para>计划任务</para>
		<screen>
		<![CDATA[
@Component
@EnableScheduling
public class MyTask {

    @Scheduled(cron="*/3 * * * * *")
    public void myTaskMethod(){
        //do something
    }
}		
		]]>
		</screen>
	</section>
	<section id="http">
		<title>HttpServletRequest / HttpServletResponse </title>
		<programlisting>
		<![CDATA[
		]]>
		</programlisting>
	</section>
	
</section>
